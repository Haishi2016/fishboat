<html>
	<head>
			<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
			<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
			<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
			<script src="../../fishboat-0.1.0.js"></script>
			<link type="text/css" rel="stylesheet" href="../../fishboat-simple-0.1.0.css" />
	</head>
	<body>
		<h1>Ad Banner Generator</h1>		
		<div class="row">
		<div class="container col-md-6">
			<form action="javascript:updateProgress()">
				<div class="form-group">
					<label for="usr">Name:</label>
					<input type="text" class="form-control" id="product">
				</div>
				<div class="form-group">
					<label for="pwd">Category:</label>
					<select class="form-control">
						<option value="one">One</option>
						<option value="two">Two</option>
						<option value="three">Three</option>
						<option value="four">Four</option>
						<option value="five">Five</option>
					</select>
				</div> 
				<div class="form-group">
						<label for="usr">Tag line:</label>
						<input type="text" class="form-control" id="tagline">
					</div>
				<input type="submit" class="btn btn-info" value="Generate"> 
			</form>
			<div class="progress" id="progress" style="display:none">
				<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0"
					aria-valuemin="0" aria-valuemax="100" style="width:70%">
					  0%
				</div>
			</div> 
			<div id="candidates" style="display:none">
				<h2>Candidates</h2>
				<p>Click on the design you want to use</p>
				<div id="stage"></div>
			</div>
			<div id="results" style="display:none">
					<h2>Results</h2>					
					<div id="stage2"></div>
			</div>
		</div>
	</div>
		<script>
			var shown = false;
			var valeur = 0;
			var bound = false;
			var pictures = fb.dataBuffer(["../../b3.png", "../../b2.png", "../../b1.png"], 3)			
			var pictures2 = fb.dataBuffer(["b3-2.png"], 1)		
			function updateProgress() {
				if (!shown) {
					$('.progress-bar').css('width', valeur+'%').attr('aria-valuenow', valeur);  
					$("#progress").show();
					shown = true;
					setTimeout(updateProgress, 10);
				}
				if (valeur<100) {
					valeur++;
					$('.progress-bar').css('width', valeur+'%').attr('aria-valuenow', valeur);  
					$('.progress-bar').text("Searching: " + valeur + "%")
					setTimeout(updateProgress, 10);
				} else {
					if (!bound) {
						bound = true;
						$("#progress").hide();
						$("#candidates").show();
						fb.select("stage")
				  			.add(fb.gallery(300))
				  			.bind(pictures);			
						$("img").click(function() {
							choosen(this.src);
						});
					}
				}
			}
			function choosen(src) {
				valeur = 0;				
				$('.progress-bar').css('width', valeur+'%').attr('aria-valuenow', valeur);  
				$('.progress-bar').text(valeur + "%")
				$("#candidates").hide();
				$("#progress").show();
				setTimeout(updateProgress2, 50);
			}
			function updateProgress2() {
				if (valeur<100) {
					valeur++;
					$('.progress-bar').css('width', valeur+'%').attr('aria-valuenow', valeur);  
					$('.progress-bar').text("Generating: " + valeur + "%")
					setTimeout(updateProgress2, 50);
				} else {
					$("#progress").hide();
					$("#results").show();
					fb.select("stage2")
				  	  .add(fb.gallery(600))
				  	   .bind(pictures2);			
				}
			}
			$(function() {				
			});
		</script>
	</body>
</html>